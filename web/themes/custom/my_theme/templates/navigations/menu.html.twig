{% import _self as menus %}

{{ menus.menu_links(items, attributes, 0) }}

{% macro menu_links(items, attributes, menu_level) %}
  {% import _self as menus %}

  {% if items %}
    {% if menu_level == 0 %}
      <div class="navbar-nav mx-0 mx-lg-auto">
    {% else %}
      <div class="dropdown-menu">
    {% endif %}

    {% for item in items %}
      {% set active_class = item.in_active_trail ? ' active' : '' %}

      {% if item.below %}
        <div class="nav-item dropdown{{ active_class }}">
          <a href="{{ item.url }}" 
             class="nav-link dropdown-toggle{{ active_class }}" 
             data-bs-toggle="dropdown">
            {{ item.title }}
          </a>
          {{ menus.menu_links(item.below, attributes, menu_level + 1) }}
        </div>
      {% else %}
        {% if menu_level == 0 %}
          <a href="{{ item.url }}" 
             class="nav-item nav-link{{ active_class }}">
            {{ item.title }}
          </a>
        {% else %}
          <a href="{{ item.url }}" 
             class="dropdown-item{{ active_class }}">
            {{ item.title }}
          </a>
        {% endif %}
      {% endif %}
    {% endfor %}

    </div>
  {% endif %}
{% endmacro %}
